<div class="booking-container">
  <div class="booking-header">
    <h1>Book Appointment</h1>
    <div class="steps-indicator">
      <div class="step" [class.active]="step >= 1" [class.completed]="step > 1">1</div>
      <div class="step-line" [class.active]="step > 1"></div>
      <div class="step" [class.active]="step >= 2" [class.completed]="step > 2">2</div>
      <div class="step-line" [class.active]="step > 2"></div>
      <div class="step" [class.active]="step >= 3">3</div>
    </div>
  </div>

  <div class="booking-card">
    @if (step === 1) {
      <div class="step-content">
        <h2>Client Information</h2>
        
        <div class="form-group">
          <label for="clientName">Client Name</label>
          <input
            type="text"
            id="clientName"
            [(ngModel)]="clientName"
            placeholder="John Doe"
          />
        </div>

        <div class="form-group">
          <label for="clientEmail">Client Email</label>
          <input
            type="email"
            id="clientEmail"
            [(ngModel)]="clientEmail"
            placeholder="john@example.com"
          />
        </div>

        <div class="form-group">
          <label for="appointmentType">Appointment Type</label>
          <select id="appointmentType" [(ngModel)]="appointmentType">
            <option value="initial">Initial Consultation</option>
            <option value="follow-up">Follow-up</option>
            <option value="emergency">Emergency</option>
          </select>
        </div>

        <div class="button-group">
          <button class="secondary-btn" routerLink="/dashboard">Cancel</button>
          <button class="primary-btn" (click)="nextStep()" [disabled]="!clientName || !clientEmail">
            Next
          </button>
        </div>
      </div>
    }

    @if (step === 2) {
      <div class="step-content">
        <h2>Select Date & Time</h2>
        
        <div class="form-group">
          <label for="date">Date</label>
          <input
            type="date"
            id="date"
            [value]="selectedDate ? selectedDate.toISOString().split('T')[0] : ''"
            (change)="onDateChange($event)"
          />
        </div>

        @if (loading) {
          <div class="loading">Loading available slots...</div>
        } @else if (selectedDate) {
          <app-slot-grid
            [slots]="availableSlots"
            [selectedSlot]="selectedSlot"
            (slotSelected)="selectSlot($event)"
          />
        }

        <div class="button-group">
          <button class="secondary-btn" (click)="prevStep()">Back</button>
          <button class="primary-btn" (click)="nextStep()" [disabled]="!selectedSlot">
            Next
          </button>
        </div>
      </div>
    }

    @if (step === 3) {
      <div class="step-content">
        <h2>Confirm Booking</h2>
        
        <div class="confirmation-details">
          <div class="detail-row">
            <span class="label">Client:</span>
            <span class="value">{{ clientName }}</span>
          </div>
          <div class="detail-row">
            <span class="label">Email:</span>
            <span class="value">{{ clientEmail }}</span>
          </div>
          <div class="detail-row">
            <span class="label">Type:</span>
            <span class="value">{{ appointmentType }}</span>
          </div>
          @if (selectedSlot) {
            <div class="detail-row">
              <span class="label">Date & Time:</span>
              <span class="value">
                {{ selectedSlot.start | date:'fullDate' }} at {{ selectedSlot.start | date:'shortTime' }}
              </span>
            </div>
          }
        </div>

        <div class="form-group">
          <label for="notes">Notes (Optional)</label>
          <textarea
            id="notes"
            [(ngModel)]="notes"
            rows="4"
            placeholder="Any additional information..."
          ></textarea>
        </div>

        <div class="button-group">
          <button class="secondary-btn" (click)="prevStep()">Back</button>
          <button class="primary-btn" (click)="submitBooking()" [disabled]="submitting">
            {{ submitting ? 'Booking...' : 'Confirm Booking' }}
          </button>
        </div>
      </div>
    }
  </div>
</div>
