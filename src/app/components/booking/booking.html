<div class="booking-container">
  <div class="booking-header">
    <h1>New Appointment</h1>
    <button class="close-btn" routerLink="/dashboard">Ã—</button>
  </div>

  <div class="booking-card">
    <div class="booking-form">
      <div class="form-group">
        <label for="clientName">Guest Name *</label>
        <input
          type="text"
          id="clientName"
          [(ngModel)]="clientName"
          placeholder="John Doe"
          autofocus
        />
      </div>

      <div class="form-group">
        <label for="clientEmail">Guest Email *</label>
        <input
          type="email"
          id="clientEmail"
          [(ngModel)]="clientEmail"
          placeholder="john@example.com"
        />
      </div>

      <div class="form-group">
        <label for="date">Date *</label>
        <input
          type="date"
          id="date"
          [value]="selectedDate ? selectedDate.toISOString().split('T')[0] : ''"
          (change)="onDateChange($event)"
        />
      </div>

      @if (selectedDate) {
        <div class="form-group">
          <label>Select Time Slot *</label>
          @if (loading) {
            <div class="loading">Loading available slots...</div>
          } @else {
            <div class="slots-grid">
              @for (slot of availableSlots; track slot.id) {
                <button
                  class="slot-btn"
                  [class.selected]="selectedSlot?.id === slot.id"
                  [class.unavailable]="!slot.available"
                  [disabled]="!slot.available"
                  (click)="selectSlot(slot)"
                >
                  {{ slot.start | date:'shortTime' }}
                </button>
              }
            </div>
          }
        </div>
      }

      <div class="form-group">
        <label for="notes">Meeting Title</label>
        <input
          type="text"
          id="notes"
          [(ngModel)]="notes"
          placeholder="e.g., Product Demo, Strategy Call"
        />
      </div>

      <div class="button-group">
        <button class="secondary-btn" routerLink="/dashboard">Cancel</button>
        <button 
          class="primary-btn" 
          (click)="submitBooking()" 
          [disabled]="!clientName || !clientEmail || !selectedSlot || submitting"
        >
          {{ submitting ? 'Creating...' : 'Create Appointment' }}
        </button>
      </div>
    </div>
  </div>
</div>
